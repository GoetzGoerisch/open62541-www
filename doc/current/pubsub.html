

<!DOCTYPE html>
<!--[if IE 8]><html class="no-js lt-ie9" lang="en" > <![endif]-->
<!--[if gt IE 8]><!--> <html class="no-js" lang="en" > <!--<![endif]-->
<head>
  <meta charset="utf-8">
  
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  
  <title>Publish/Subscribe &mdash; open62541 0.4.0-dev documentation</title>
  

  
  
  
  

  

  
  
    

  

  
    <link rel="stylesheet" href="_static/css/theme.css" type="text/css" />
  <link rel="stylesheet" href="_static/pygments.css" type="text/css" />
    <link rel="index" title="Index" href="genindex.html" />
    <link rel="search" title="Search" href="search.html" />
    <link rel="prev" title="PubSub Connection Plugin API" href="plugin_pubsub_connection.html" /> 

  
  <script src="_static/js/modernizr.min.js"></script>

</head>

<body class="wy-body-for-nav">

   
  <div class="wy-grid-for-nav">

    
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search">
          

          
            <a href="toc.html" class="icon icon-home"> open62541
          

          
            
            <img src="_static/open62541_html.png" class="logo" alt="Logo"/>
          
          </a>

          
            
            
              <div class="version">
                0.4
              </div>
            
          

          
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>

          
        </div>

        <div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="main navigation">
          
            
            
              
            
            
              <ul class="current">
<li class="toctree-l1"><a class="reference internal" href="index.html">Introduction</a></li>
<li class="toctree-l1"><a class="reference internal" href="building.html">Building open62541</a></li>
<li class="toctree-l1"><a class="reference internal" href="tutorials.html">Tutorials</a></li>
<li class="toctree-l1"><a class="reference internal" href="protocol.html">Protocol</a></li>
<li class="toctree-l1"><a class="reference internal" href="types.html">Data Types</a></li>
<li class="toctree-l1"><a class="reference internal" href="services.html">Services</a></li>
<li class="toctree-l1"><a class="reference internal" href="nodestore.html">Information Modelling</a></li>
<li class="toctree-l1"><a class="reference internal" href="server.html">Server</a></li>
<li class="toctree-l1"><a class="reference internal" href="client.html">Client</a></li>
<li class="toctree-l1"><a class="reference internal" href="constants.html">Standard-Defined Constants</a></li>
<li class="toctree-l1"><a class="reference internal" href="nodeset_compiler.html">XML Nodeset Compiler</a></li>
<li class="toctree-l1 current"><a class="reference internal" href="internal.html">Internals</a><ul class="current">
<li class="toctree-l2"><a class="reference internal" href="statuscodes.html">StatusCodes</a></li>
<li class="toctree-l2"><a class="reference internal" href="plugin_network.html">Networking Plugin API</a></li>
<li class="toctree-l2"><a class="reference internal" href="plugin_access_control.html">Access Control Plugin API</a></li>
<li class="toctree-l2"><a class="reference internal" href="plugin_log.html">Logging Plugin API</a></li>
<li class="toctree-l2"><a class="reference internal" href="plugin_pubsub_connection.html">PubSub Connection Plugin API</a></li>
<li class="toctree-l2 current"><a class="current reference internal" href="#">Publish/Subscribe</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#connections">Connections</a><ul>
<li class="toctree-l4"><a class="reference internal" href="#connection-handling">Connection handling</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="#publisheddatasets">PublishedDataSets</a><ul>
<li class="toctree-l4"><a class="reference internal" href="#publisheddataset-handling">PublishedDataSet handling</a></li>
</ul>
</li>
</ul>
</li>
</ul>
</li>
</ul>

            
          
        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap">

      
      <nav class="wy-nav-top" aria-label="top navigation">
        
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="toc.html">open62541</a>
        
      </nav>


      <div class="wy-nav-content">
        
        <div class="rst-content">
        
          















<div role="navigation" aria-label="breadcrumbs navigation">

  <ul class="wy-breadcrumbs">
    
      <li><a href="toc.html">Docs</a> &raquo;</li>
        
          <li><a href="internal.html">Internals</a> &raquo;</li>
        
      <li>Publish/Subscribe</li>
    
    
      <li class="wy-breadcrumbs-aside">
        
            
            <a href="_sources/pubsub.rst.txt" rel="nofollow"> View page source</a>
          
        
      </li>
    
  </ul>

  
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
            
  <div class="section" id="publish-subscribe">
<span id="pubsub"></span><h1>Publish/Subscribe<a class="headerlink" href="#publish-subscribe" title="Permalink to this headline">¶</a></h1>
<p>Work in progress!
This part will be a new chapter later.</p>
<p>TODO: write general PubSub introduction</p>
<p>The Publish/Subscribe (PubSub) extension for OPC UA enables fast and efficient
1:m communication. The PubSub extension is protocol agnostic and can be used
with broker based protocols like MQTT and AMQP or brokerless implementations like UDP-Multicasting.</p>
<p>The PubSub API uses the following scheme:</p>
<ol class="arabic simple">
<li>Create a configuration for the needed PubSub element.</li>
<li>Call the add[element] function and pass in the configuration.</li>
<li>The add[element] function returns the unique nodeId of the internally created element.</li>
</ol>
<p>Take a look on the PubSub Tutorials for mor details about the API usage.:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="o">+-----------+</span>
<span class="o">|</span> <span class="n">UA_Server</span> <span class="o">|</span>
<span class="o">+-----------+</span>
 <span class="o">|</span>    <span class="o">|</span>
 <span class="o">|</span>    <span class="o">|</span>
 <span class="o">|</span>    <span class="o">|</span>
 <span class="o">|</span>    <span class="o">|</span>  <span class="o">+----------------------+</span>
 <span class="o">|</span>    <span class="o">+-&gt;|</span> <span class="n">UA_PubSubConnections</span> <span class="o">|</span>  <span class="n">UA_Server_addPubSubConnection</span>
 <span class="o">|</span>       <span class="o">+----------------------+</span>
 <span class="o">|</span>        <span class="o">|</span>    <span class="o">|</span>
 <span class="o">|</span>        <span class="o">|</span>    <span class="o">|</span>    <span class="o">+-----------------------+</span>
 <span class="o">|</span>        <span class="o">|</span>    <span class="o">+---&gt;|</span> <span class="n">UA_PubSubWriterGroups</span> <span class="o">|</span>
 <span class="o">|</span>        <span class="o">|</span>         <span class="o">+-----------------------+</span>
 <span class="o">|</span>        <span class="o">|</span>
 <span class="o">|</span>        <span class="o">|</span>         <span class="o">+-----------------------+</span>
 <span class="o">|</span>        <span class="o">+--------&gt;|</span> <span class="n">UA_PubSubReaderGroups</span> <span class="o">|</span>
 <span class="o">|</span>                  <span class="o">+-----------------------+</span>
 <span class="o">|</span>
 <span class="o">|</span>       <span class="o">+---------------------------+</span>
 <span class="o">+------&gt;|</span> <span class="n">UA_PubSubPublishedDataSet</span> <span class="o">|</span>  <span class="n">UA_Server_addPublishedDataSet</span>
         <span class="o">+---------------------------+</span>
</pre></div>
</div>
<div class="section" id="connections">
<h2>Connections<a class="headerlink" href="#connections" title="Permalink to this headline">¶</a></h2>
<p>The PubSub connections are the abstraction between the concrete transport protocol
and the PubSub functionality. It is possible to create multiple connections with
different transport protocols at runtime.</p>
<p>Take a look on the PubSub Tutorials for mor details about the API usage.
Connections
———–</p>
<div class="highlight-c notranslate"><div class="highlight"><pre><span></span><span class="k">typedef</span> <span class="k">struct</span><span class="p">{</span>
    <span class="n">UA_String</span> <span class="n">name</span><span class="p">;</span>
    <span class="n">UA_Boolean</span> <span class="n">enabled</span><span class="p">;</span>
    <span class="k">union</span><span class="p">{</span> <span class="c1">//std: valid types UInt or String</span>
        <span class="n">UA_UInt32</span> <span class="n">numeric</span><span class="p">;</span>
        <span class="n">UA_String</span> <span class="n">string</span><span class="p">;</span>
    <span class="p">}</span><span class="n">publisherId</span><span class="p">;</span>
    <span class="n">UA_String</span> <span class="n">transportProfileUri</span><span class="p">;</span>
    <span class="n">UA_Variant</span> <span class="n">address</span><span class="p">;</span>
    <span class="kt">size_t</span> <span class="n">connectionPropertiesSize</span><span class="p">;</span>
    <span class="n">UA_KeyValuePair</span> <span class="o">*</span><span class="n">connectionProperties</span><span class="p">;</span>
    <span class="n">UA_Variant</span> <span class="n">connectionTransportSettings</span><span class="p">;</span>
<span class="p">}</span> <span class="n">UA_PubSubConnectionConfig</span><span class="p">;</span>
</pre></div>
</div>
<div class="section" id="connection-handling">
<h3>Connection handling<a class="headerlink" href="#connection-handling" title="Permalink to this headline">¶</a></h3>
<div class="highlight-c notranslate"><div class="highlight"><pre><span></span><span class="n">UA_StatusCode</span>
<span class="nf">UA_Server_addPubSubConnection</span><span class="p">(</span><span class="n">UA_Server</span> <span class="o">*</span><span class="n">server</span><span class="p">,</span> <span class="k">const</span> <span class="n">UA_PubSubConnectionConfig</span> <span class="o">*</span><span class="n">connectionConfig</span><span class="p">,</span>
                              <span class="n">UA_NodeId</span> <span class="o">*</span><span class="n">connectionIdentifier</span><span class="p">);</span>

<span class="n">UA_StatusCode</span>
<span class="nf">UA_Server_removePubSubConnection</span><span class="p">(</span><span class="n">UA_Server</span> <span class="o">*</span><span class="n">server</span><span class="p">,</span> <span class="n">UA_NodeId</span> <span class="n">connectionIdentifier</span><span class="p">);</span>

<span class="n">UA_StatusCode</span>
<span class="nf">UA_PubSubConnection_getConfig</span><span class="p">(</span><span class="n">UA_Server</span> <span class="o">*</span><span class="n">server</span><span class="p">,</span> <span class="n">UA_NodeId</span> <span class="n">connectionIdentifier</span><span class="p">,</span>
                              <span class="n">UA_PubSubConnectionConfig</span> <span class="o">*</span><span class="n">config</span><span class="p">);</span>
</pre></div>
</div>
</div>
</div>
<div class="section" id="publisheddatasets">
<h2>PublishedDataSets<a class="headerlink" href="#publisheddatasets" title="Permalink to this headline">¶</a></h2>
<p>The PublishedDataSets (PDS) are containers for the published information. The PDS contain
the published variables and meta informations. The metainformations are commonly autogenerated
or given as constant argument as part of the template functions. The template functions are standard
defined and should only be used for configuration tools. You should normally
create a empty PDS and call the functions to add new fields.</p>
<div class="highlight-c notranslate"><div class="highlight"><pre><span></span><span class="k">typedef</span> <span class="k">struct</span> <span class="p">{</span>
    <span class="n">UA_StatusCode</span> <span class="n">addResult</span><span class="p">;</span>
    <span class="kt">size_t</span> <span class="n">fieldAddResultsSize</span><span class="p">;</span>
    <span class="n">UA_StatusCode</span> <span class="o">*</span><span class="n">fieldAddResults</span><span class="p">;</span>
    <span class="n">UA_ConfigurationVersionDataType</span> <span class="n">configurationVersion</span><span class="p">;</span>
<span class="p">}</span> <span class="n">UA_AddPublishedDataSetResult</span><span class="p">;</span>

<span class="k">typedef</span> <span class="k">enum</span> <span class="p">{</span>
    <span class="n">UA_PUBSUB_DATASET_PUBLISHEDITEMS</span><span class="p">,</span>
    <span class="n">UA_PUBSUB_DATASET_PUBLISHEDEVENTS</span><span class="p">,</span>
    <span class="n">UA_PUBSUB_DATASET_PUBLISHEDITEMS_TEMPLATE</span><span class="p">,</span>
    <span class="n">UA_PUBSUB_DATASET_PUBLISHEDEVENTS_TEMPLATE</span><span class="p">,</span>
<span class="p">}</span> <span class="n">UA_PublishedDataSetType</span><span class="p">;</span>

<span class="cm">/* The UA_PUBSUB_DATASET_PUBLISHEDITEMS has currently no additional members</span>
<span class="cm"> * and thus no dedicated config structure.</span>
<span class="cm"> */</span>

<span class="k">typedef</span> <span class="k">struct</span> <span class="p">{</span>
    <span class="n">UA_DataSetMetaDataType</span> <span class="n">metaData</span><span class="p">;</span>
    <span class="kt">size_t</span> <span class="n">variablesToAddSize</span><span class="p">;</span>
    <span class="n">UA_PublishedVariableDataType</span> <span class="o">*</span><span class="n">variablesToAdd</span><span class="p">;</span>
<span class="p">}</span> <span class="n">UA_PublishedDataItemsTemplateConfig</span><span class="p">;</span>

<span class="k">typedef</span> <span class="k">struct</span> <span class="p">{</span>
    <span class="n">UA_NodeId</span> <span class="n">eventNotfier</span><span class="p">;</span>
    <span class="n">UA_ContentFilter</span> <span class="n">filter</span><span class="p">;</span>
<span class="p">}</span> <span class="n">UA_PublishedEventConfig</span><span class="p">;</span>

<span class="k">typedef</span> <span class="k">struct</span> <span class="p">{</span>
    <span class="n">UA_DataSetMetaDataType</span> <span class="n">metaData</span><span class="p">;</span>
    <span class="n">UA_NodeId</span> <span class="n">eventNotfier</span><span class="p">;</span>
    <span class="kt">size_t</span> <span class="n">selectedFieldsSize</span><span class="p">;</span>
    <span class="n">UA_SimpleAttributeOperand</span> <span class="o">*</span><span class="n">selectedFields</span><span class="p">;</span>
    <span class="n">UA_ContentFilter</span> <span class="n">filter</span><span class="p">;</span>
<span class="p">}</span> <span class="n">UA_PublishedEventTemplateConfig</span><span class="p">;</span>

<span class="cm">/* Configuration structure for PubSubDataSet */</span>
<span class="k">typedef</span> <span class="k">struct</span> <span class="p">{</span>
    <span class="n">UA_String</span> <span class="n">name</span><span class="p">;</span>
    <span class="n">UA_PublishedDataSetType</span> <span class="n">publishedDataSetType</span><span class="p">;</span>
    <span class="k">union</span><span class="p">{</span>
        <span class="cm">/* The UA_PUBSUB_DATASET_PUBLISHEDITEMS has currently no additional members</span>
<span class="cm">         * and thus no dedicated config structure.*/</span>
        <span class="n">UA_PublishedDataItemsTemplateConfig</span> <span class="n">itemsTemplate</span><span class="p">;</span>
        <span class="n">UA_PublishedEventConfig</span> <span class="n">event</span><span class="p">;</span>
        <span class="n">UA_PublishedEventTemplateConfig</span> <span class="n">eventTemplate</span><span class="p">;</span>
    <span class="p">}</span> <span class="n">config</span><span class="p">;</span>
<span class="p">}</span> <span class="n">UA_PublishedDataSetConfig</span><span class="p">;</span>
</pre></div>
</div>
<div class="section" id="publisheddataset-handling">
<h3>PublishedDataSet handling<a class="headerlink" href="#publisheddataset-handling" title="Permalink to this headline">¶</a></h3>
<div class="highlight-c notranslate"><div class="highlight"><pre><span></span><span class="n">UA_AddPublishedDataSetResult</span>
<span class="nf">UA_Server_addPublishedDataSet</span><span class="p">(</span><span class="n">UA_Server</span> <span class="o">*</span><span class="n">server</span><span class="p">,</span> <span class="k">const</span> <span class="n">UA_PublishedDataSetConfig</span> <span class="o">*</span><span class="n">publishedDataSetConfig</span><span class="p">,</span>
                              <span class="n">UA_NodeId</span> <span class="o">*</span><span class="n">pdsIdentifier</span><span class="p">);</span>

<span class="n">UA_StatusCode</span>
<span class="nf">UA_Server_removePublishedDataSet</span><span class="p">(</span><span class="n">UA_Server</span> <span class="o">*</span><span class="n">server</span><span class="p">,</span> <span class="n">UA_NodeId</span> <span class="n">pdsIdentifier</span><span class="p">);</span>

<span class="n">UA_StatusCode</span>
<span class="nf">UA_PublishedDataSet_getConfig</span><span class="p">(</span><span class="n">UA_Server</span> <span class="o">*</span><span class="n">server</span><span class="p">,</span> <span class="n">UA_NodeId</span> <span class="n">publishedDataSetIdentifier</span><span class="p">,</span>
                              <span class="n">UA_PublishedDataSetConfig</span> <span class="o">*</span><span class="n">config</span><span class="p">);</span>
<span class="kt">void</span>
<span class="nf">UA_PublishedDataSetConfig_deleteMembers</span><span class="p">(</span><span class="n">UA_PublishedDataSetConfig</span> <span class="o">*</span><span class="n">pdsConfig</span><span class="p">);</span>
</pre></div>
</div>
</div>
</div>
</div>


           </div>
           
          </div>
          <footer>
  
    <div class="rst-footer-buttons" role="navigation" aria-label="footer navigation">
      
      
        <a href="plugin_pubsub_connection.html" class="btn btn-neutral" title="PubSub Connection Plugin API" accesskey="p" rel="prev"><span class="fa fa-arrow-circle-left"></span> Previous</a>
      
    </div>
  

  <hr/>

  <div role="contentinfo">
    <p>
        &copy; Copyright 2016, The open62541 authors.

    </p>
  </div>
  Built with <a href="http://sphinx-doc.org/">Sphinx</a> using a <a href="https://github.com/rtfd/sphinx_rtd_theme">theme</a> provided by <a href="https://readthedocs.org">Read the Docs</a>. 

</footer>

        </div>
      </div>

    </section>

  </div>
  


  

    <script type="text/javascript">
        var DOCUMENTATION_OPTIONS = {
            URL_ROOT:'./',
            VERSION:'0.4.0-dev',
            LANGUAGE:'en',
            COLLAPSE_INDEX:false,
            FILE_SUFFIX:'.html',
            HAS_SOURCE:  true,
            SOURCELINK_SUFFIX: '.txt'
        };
    </script>
      <script type="text/javascript" src="_static/jquery.js"></script>
      <script type="text/javascript" src="_static/underscore.js"></script>
      <script type="text/javascript" src="_static/doctools.js"></script>

  

  
  
    <script type="text/javascript" src="_static/js/theme.js"></script>
  

  <script type="text/javascript">
      jQuery(function () {
          
          SphinxRtdTheme.Navigation.enableSticky();
          
      });
  </script> 

</body>
</html>